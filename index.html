<!DOCTYPE html>
<html>
<head>
  <!--
    If you are serving your web app in a path other than the root, change the
    href value below to reflect the base path you are serving from.

    The path provided below has to start and end with a slash "/" in order for
    it to work correctly.

    For more details:
    * https://developer.mozilla.org/en-US/docs/Web/HTML/Element/base

    This is a placeholder for base href that will be replaced by the value of
    the `--base-href` argument provided to `flutter build`.
  -->
  <base href="/">

  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="A new Flutter project.">

  <!-- iOS meta tags & icons -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="request_defendant_info">
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png"/>

  <title>request_defendant_info</title>
  <link rel="manifest" href="manifest.json">

  <script>
    // The value below is injected by flutter build, do not touch.
    const serviceWorkerVersion = "1987805853";
  </script>
  <!-- This script adds the flutter initialization JS code -->
  <script src="flutter.js" defer></script>
</head>
<body>
  <script>
    window.addEventListener('load', function(ev) {
      // Download main.dart.js
      _flutter.loader.loadEntrypoint({
        serviceWorker: {
          serviceWorkerVersion: serviceWorkerVersion,
        },
        onEntrypointLoaded: function(engineInitializer) {
          engineInitializer.initializeEngine().then(function(appRunner) {
            appRunner.runApp();
          });
        }
      });
    });
  </script>
  <script src="word.js"></script>
   <!-- <script src="https://unpkg.com/docx@7.1.0/build/index.js"></script>
   <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/1.3.8/FileSaver.js"></script> -->
   <script>
    

    function generate(defendantQuantity, detailsAcquiredList, detailsNeededList, detailsNeededRowList) {
      

      function populateTableCellsDetails(type) {

        var acquiredTableCells = [];

        var neededTableCells = [];

        if (type == 0) {
          for (var i = 0; i < detailsAcquiredRowList.length; i++) {
            acquiredTableCells.push(
              new docx.TableCell({
                width: {
                  size: 30,
                  type: docx.WidthType.PERCENTAGE,
                },
                children: [
                  new docx.Paragraph({
                    heading: docx.HeadingLevel.HEADING_3,
                    alignment: docx.AlignmentType.CENTER,
                    children: [
                      new docx.TextRun({
                        text: detailsAcquiredRowList[i],
                        bold: true,
                        font: "Calibri",
                        allCaps: true,
                        color: "000000"
                      })
                    ],
                  }),
                ],
                margins: {
                  top: 64,
                  bottom: 64,
                  left: 64,
                  right: 64,
                },
                verticalAlign: docx.VerticalAlign.CENTER,
                textDirection: docx.TextDirection.RIGHT_TO_LEFT,
              }),);
          }
          return acquiredTableCells.reverse();
        } else {

          for (var i = 0; i < detailsNeededRowList.length; i++) {
            neededTableCells.push(
              new docx.TableCell({
                width: {
                  size: 30,
                  type: docx.WidthType.PERCENTAGE,
                },
                children: [
                  new docx.Paragraph({
                    heading: docx.HeadingLevel.HEADING_3,
                    alignment: docx.AlignmentType.CENTER,
                    children: [
                      new docx.TextRun({
                        text: detailsNeededRowList[i],
                        bold: true,
                        font: "Calibri",
                        allCaps: true,
                        color: "000000"
                      })
                    ],
                  }),
                ],
                margins: {
                  top: 64,
                  bottom: 64,
                  left: 64,
                  right: 64,
                },
                verticalAlign: docx.VerticalAlign.CENTER,
                textDirection: docx.TextDirection.RIGHT_TO_LEFT,
              }),);
          }
          return neededTableCells.reverse();
        }
      }
      

      function populateTableCells(type) {

        var acquiredTableCells = [];

        var neededTableCells = [];

        if(type == 0) {
          for(var i = 0; i < detailsAcquiredList.length; i++) {
          acquiredTableCells.push(
            new docx.TableCell({
                width: {
                      size: 30,
                      type: docx.WidthType.PERCENTAGE,
                  },
                  children: [
                        new docx.Paragraph({
                            heading: docx.HeadingLevel.HEADING_3,
                            alignment: docx.AlignmentType.CENTER,
                            children: [
                            new docx.TextRun({
                                text: detailsAcquiredList[i],
                                bold: true,
                                font: "Calibri",
                                allCaps: true,
                                color: "000000"
                            })
                            ],
                        }),
                    ],
                    margins: {
                            top: 64,
                            bottom: 64,
                            left: 64,
                            right: 64,
                          },
                    verticalAlign: docx.VerticalAlign.CENTER,
                    textDirection: docx.TextDirection.RIGHT_TO_LEFT,
              }),);
        }
        return acquiredTableCells.reverse();
        } else {
          
          for(var i = 0; i < detailsNeededList.length; i++) {
          neededTableCells.push(
            new docx.TableCell({
                      width: {
                            size: 30,
                            type: docx.WidthType.PERCENTAGE,
                        },
                         
                          children: [
                              new docx.Paragraph({
                                  heading: docx.HeadingLevel.HEADING_3,
                                  alignment: docx.AlignmentType.CENTER,
                                  children: [
                                  new docx.TextRun({
                                      text:  "يرجى التكرم بتعبئة ",
                                      bold: true,
                                      font: "Calibri",
                                      allCaps: true,
                                      color: "000000",
                                      bidirectional: true,
                                  }),
                                  new docx.TextRun({
                                      text:  detailsNeededList[i],
                                      bold: true,
                                      underline: {
                                      },
                                      font: "Calibri",
                                      allCaps: true,
                                      color: "000000",
                                      bidirectional: true,
                                  }),
                                  new docx.TextRun({
                                      text:  " في هذا المكان ",
                                      bold: true,
                                      font: "Calibri",
                                      allCaps: true,
                                      color: "000000",

                                      bidirectional: true,
                                  })
                                  ],
                              }),
                          ],
                          margins: {
                            top: 64,
                            bottom: 64,
                            left: 64,
                            right: 64,
                          },
                          verticalAlign: docx.VerticalAlign.CENTER,
                          textDirection: docx.TextDirection.RIGHT_TO_LEFT,
                    }),
                   
          );
        }
        return neededTableCells.reverse();
        }
      }

      function populateTableHeader() {
        return new docx.TableRow({
                children: [
                    ...populateTableCells(1),
                    ...populateTableCells(0),
                    new docx.TableCell({
                      width: {
                            size: 10,
                            type: docx.WidthType.PERCENTAGE,
                        },
                          children: [
                              new docx.Paragraph({
                                  heading: docx.HeadingLevel.HEADING_3,
                                  alignment: docx.AlignmentType.CENTER,
                                  children: [
                                  new docx.TextRun({
                                      text: "ت",
                                      bold: true,
                                      font: "Calibri",
                                      allCaps: true,
                                      color: "000000"
                                  })
                                  ],
                              }),
                          ],

                          textDirection: docx.TextDirection.RIGHT_TO_LEFT,
                          verticalAlign: docx.VerticalAlign.CENTER,
                    }),
                ],
              })
      }

      function populateTableRows() {
        var tableRowArray = [];
        for(var i = 0; i < defendantQuantity; i++) {

          
           tableRowArray.push(
            new docx.TableRow({
                children: [
                    new docx.TableCell({
                      width: {
                            size: 25,
                            type: docx.WidthType.PERCENTAGE,
                        },
                        children: [
                              new docx.Paragraph({
                                  heading: docx.HeadingLevel.HEADING_3,
                                  alignment: docx.AlignmentType.CENTER,
                                  children: [
                                  new docx.TextRun({
                                      text: detailsNeededRowList[i][2],
                                      font: "Calibri",
                                      bold: true,
                                      color: "000000",
                                      bidirectional: true,
                                  })
                                  ],
                              }),
                          ],
                          margins: {
                            top: 64,
                            bottom: 64,
                            left: 64,
                            right: 64,
                          },
                          verticalAlign: docx.VerticalAlign.CENTER,
                          textDirection: docx.TextDirection.RIGHT_TO_LEFT,
                    }),
                    new docx.TableCell({
                      width: {
                            size: 25,
                            type: docx.WidthType.PERCENTAGE,
                        },
                        children: [
                              new docx.Paragraph({
                                  heading: docx.HeadingLevel.HEADING_3,
                                  alignment: docx.AlignmentType.CENTER,
                                  children: [
                                  new docx.TextRun({
                                      text:  detailsNeededRowList[i][1] != '' ? detailsNeededRowList[i][0] : detailsNeededRowList[i][1],
                                      font: "Calibri",
                                      bold: true,
                                      color: "000000",
                                      bidirectional: true,
                                  })
                                  ],
                              }),
                          ],
                          margins: {
                            top: 64,
                            bottom: 64,
                            left: 64,
                            right: 64,
                          },
                          verticalAlign: docx.VerticalAlign.CENTER,
                          textDirection: docx.TextDirection.RIGHT_TO_LEFT,
                    }),
                    new docx.TableCell({
                      width: {
                            size: 40,
                            type: docx.WidthType.PERCENTAGE,
                        },
                        children: [
                              new docx.Paragraph({
                                  heading: docx.HeadingLevel.HEADING_3,
                                  alignment: docx.AlignmentType.CENTER,
                                  children: [
                                  new docx.TextRun({
                                      text: detailsNeededRowList[i][1] != '' ? detailsNeededRowList[i][1] : detailsNeededRowList[i][0],
                                      bold: true,
                                      font: "Calibri",
                                      allCaps: true,
                                      color: "000000"
                                  })
                                  ],
                              }),
                          ],
                          margins: {
                            top: 64,
                            bottom: 64,
                            left: 64,
                            right: 64,
                          },
                          verticalAlign: docx.VerticalAlign.CENTER,
                          textDirection: docx.TextDirection.RIGHT_TO_LEFT,
                    }),
                    new docx.TableCell({
                      width: {
                            size: 10,
                            type: docx.WidthType.PERCENTAGE,
                        },
                          children: [
                              new docx.Paragraph({
                                  heading: docx.HeadingLevel.HEADING_3,
                                  alignment: docx.AlignmentType.CENTER,
                                  children: [
                                  new docx.TextRun({
                                      text: i+1,
                                      bold: true,
                                      font: "Calibri",
                                      allCaps: true,
                                      color: "000000"
                                  })
                                  ],
                              }),
                          ],
                          margins: {
                            top: 64,
                            bottom: 64,
                            left: 64,
                            right: 64,
                          },
                          textDirection: docx.TextDirection.RIGHT_TO_LEFT,
                          verticalAlign: docx.VerticalAlign.CENTER,
                    }),
                ],
              }
            )
          )
        }
        
        return tableRowArray;
      }

      const table = new docx.Table({
        rows: [
                populateTableHeader(),
              ...populateTableRows(),
          ],
    });
        

        const thanksTextLine1 = new docx.TextRun({
            text: ".آملين أن يصلنا ردكم في أقرب وقت ممكن",
            bold: true,
            font: "Calibri",
            allCaps: true,
            color: "000000"
        });
        const thanksTextLine2 = new docx.TextRun({
            text: ".شاكرين حسن تعاونكم الدائم معنا",
            bold: true,
            font: "Calibri",
            allCaps: true,
            color: "000000"
        });
        const thanksTextLine3 = new docx.TextRun({
            text: ".و تفضلوا بقبول فائق الإحترام و التقدير",
            bold: true,
            font: "Calibri",
            allCaps: true,
            color: "000000"
        });
       
        const thanksParaLine1 = new docx.Paragraph({
            heading: docx.HeadingLevel.HEADING_2,
            alignment: docx.AlignmentType.CENTER,
            children: [
            thanksTextLine1,
            ],
        });

        const thanksParaLine2 = new docx.Paragraph({
            heading: docx.HeadingLevel.HEADING_2,
            alignment: docx.AlignmentType.CENTER,
            children: [
            thanksTextLine2,
            ],
        });

        const thanksParaLine3 = new docx.Paragraph({
            heading: docx.HeadingLevel.HEADING_2,
            alignment: docx.AlignmentType.CENTER,
            children: [
            thanksTextLine3,
            ],
        });

        const emptyLine = new docx.Paragraph({
            heading: docx.HeadingLevel.HEADING_2,
            alignment: docx.AlignmentType.CENTER,
            children: [
            new docx.TextRun({
            text:"",
              }),
            ],
        });

   

        const doc = new docx.Document({
          sections: [
			{
				properties: {},
				children: [
        table,
        emptyLine,
        thanksParaLine1,
        thanksParaLine2,
        thanksParaLine3,
				],
			},
		]
        });

        docx.Packer.toBlob(doc).then(blob => {
          saveAs(blob, "طلب بيانات الخصم.docx");
        });
      }
   </script>
</body>
</html>
